"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}!function(){for(var n=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var i=(new Date).getTime(),s=Math.max(0,16-(i-n)),o=window.setTimeout(function(){e(i+s)},s);return n=i+s,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var MotionGlob=function(){function i(e,t){_classCallCheck(this,i),this.container=e,this.direction=t.direction||"down",this.delayAfterHover=1e3*t.delayAfterHover||1e3,this.onhover=t.onhover||"default",this.pauseOnScroll=null==t.pauseOnScroll||t.pauseOnScroll,this.itemClass=t.itemClass||"",this.indent=t.indent||0,this.itemPosition=0+this.indent,this.itemSpeed=t.speed||1,this.original=t.original,this.key_delta=10}return _createClass(i,[{key:"init",value:function(){var t=this,i=this;this.delay=null,this.isCanReplace=!0,this.hoverAction="hoverAction",this.needSide="",this.axis="",this.motion=null,this.setMotionDirection(),this.setEdges(),this.setOriginalSize(),this.setStartPosition(),this.addToStart(),this.addToEnd(),this.firstItem=this.container.children().first(),this.lastItem=this.container.children().last(),this.setPropsToFirst(this.firstItem),this.container.children().addClass(this.hoverAction),this.onpause=!1,this.mousetimer=null,this.hoveringItem=null,"nothing"==this.onhover&&(this.mouseX=0,this.mouseY=0),this.isBGCrossProgress=!1,this.isENDCrossProgress=!1,this.render(),$(window).on("mousewheel",function(e){e.preventDefault(),i.onpause=!0,0<e.deltaY?(i.itemPosition+=e.deltaFactor,i.replaceObjects("prev")):(i.itemPosition-=e.deltaFactor,i.replaceObjects("next")),i.pauseOnScroll?(clearTimeout(i.delay),i.delay=setTimeout(function(){i.onpause=!1},i.delayAfterHover)):i.onpause=!1}),$(window).on("keydown",function(e){t.onpause=!0,37==e.keyCode||38==e.keyCode?(i.itemPosition+=t.key_delta,i.replaceObjects("prev")):39!=e.keyCode&&40!=e.keyCode||(i.itemPosition-=t.key_delta,i.replaceObjects("next"))}),$(window).on("keyup",function(e){t.onpause=!1}),"pause"==this.onhover?this.container.delegate(".hoverAction","mousemove",function(e){i.onpause=!0,i.delay=setTimeout(function(){i.onpause=!1},i.delayAfterHover)}):"nothing"==this.onhover&&(this.container.delegate(this.itemClass,"mousemove",function(e){i.mouseX=e.pageX,i.mouseY=e.pageY,$(this).addClass("-hover-"),i.hoveringItem=$(this)}),this.container.delegate(this.itemClass,"mouseleave",function(e){e.preventDefault(),$(this).removeClass("-hover-"),i.hoveringItem=null})),$(window).on("resize",function(e){i.setEdges(),i.setOriginalSize()})}},{key:"getEdgesOfHover",value:function(){this.hoverBgn=this.hoveringItem.offset().top,"horizontal"==this.axis?this.hoverEnd=this.hoveringItem.offset().left+this.hoveringItem.outerWidth():this.hoverEnd=this.hoveringItem.offset().top+this.hoveringItem.outerHeight()}},{key:"offSroll",value:function(){this.container.css("margin",0),this.container.off("mousewheel mousemove mouseleave")}},{key:"setStartPosition",value:function(){this.itemPosition=-(this.bgEdge+Math.abs(this.originalSize-this.bgEdge))}},{key:"addToStart",value:function(){var e=this.original.clone();this.container.prepend(e)}},{key:"addToEnd",value:function(){this.container.append(this.original.clone())}},{key:"replaceObjects",value:function(e){this.isCanReplace=!1;this.setPropsToFirst(this.firstItem),"next"==e?(this.isAcrossBGEdge()&&(this.isBGCrossProgress=!0,this.addToEnd(),this.lastItem=this.container.children().last()),this.isFirstOut(this.firstItem)&&(this.isBGCrossProgress=!1,this.removeElem(this.firstItem),this.firstItem=this.container.children().first(),this.itemPosition+=this.originalSize,this.setPropsToFirst(this.firstItem))):(this.isAcrossEndEdge()&&(this.isENDCrossProgress=!0,this.firstItem.css("margin",0),this.addToStart(),this.firstItem=this.container.children().first(),this.itemPosition-=this.originalSize,this.setPropsToFirst(this.firstItem)),this.isLastOut(this.lastItem)&&(this.isENDCrossProgress=!1,this.removeElem(this.lastItem),this.lastItem=this.container.children().last())),this.isCanReplace=!0}},{key:"setOriginalSize",value:function(){"horizontal"==this.axis?this.originalSize=this.original.outerWidth():this.originalSize=this.original.outerHeight()}},{key:"getLastPosition",value:function(){return"horizontal"==this.axis?this.originalSize+this.lastItem.offset().left:this.originalSize+this.lastItem.offset().top}},{key:"hoverRemove",value:function(e){clearTimeout(e.mousetimer),e.mousetimer=setTimeout(function(){$(e.itemClass).removeClass("-hover-")},1e3)}},{key:"setEdges",value:function(){"horizontal"==this.axis?(this.bgEdge=$(window).width()/2,this.endEdge=$(window).width()+this.bgEdge):(this.bgEdge=$(window).height()/2,this.endEdge=$(window).height()+this.bgEdge)}},{key:"isAcrossBGEdge",value:function(){return this.itemPosition<=-this.bgEdge&&!this.isBGCrossProgress}},{key:"isAcrossEndEdge",value:function(){return this.getLastPosition()>=this.endEdge&&!this.isENDCrossProgress}},{key:"isFirstOut",value:function(e){return this.itemPosition<-(this.bgEdge+e.outerHeight())&&"vertical"==this.axis||this.itemPosition<-(this.bgEdge+e.outerWidth())&&"horizontal"==this.axis}},{key:"isLastOut",value:function(e){return e.offset().top>this.endEdge&&"vertical"==this.axis||e.offset().left>this.endEdge&&"horizontal"==this.axis}},{key:"setMotionDirection",value:function(){"down"==this.direction?(this.needSide="top",this.axis="vertical"):"left"==this.direction&&(this.needSide="left",this.axis="horizontal")}},{key:"isInsiteOfItem",value:function(){return"horizontal"==this.axis?this.mouseX>=this.hoverBgn&&this.mouseX<=this.hoverEnd:this.mouseY>=this.hoverBgn&&this.mouseY<=this.hoverEnd}},{key:"render",value:function(){var t=this;this.requestID=window.requestAnimationFrame(function e(){null!=t.hoveringItem&&(t.getEdgesOfHover(),t.isInsiteOfItem()||(t.hoveringItem.removeClass("-hover-"),t.hoveringItem=null)),t.onpause||(t.itemPosition-=t.itemSpeed),t.setPropsToFirst(t.firstItem),!t.onpause&&t.isCanReplace&&t.replaceObjects("next"),t.requestID&&(t.requestID=window.requestAnimationFrame(e))})}},{key:"stop",value:function(){this.requestID&&(window.cancelAnimationFrame(this.requestID),this.requestID=void 0)}},{key:"appendToEnd",value:function(){}},{key:"prependToStart",value:function(){}},{key:"setPropsToFirst",value:function(e){this.container.children().css("margin",0);var t="margin-"+this.needSide;e.css(t,this.itemPosition+"px")}},{key:"removeElem",value:function(e){e.remove()}}]),i}();