function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var WorkItem=function(){function t(e){return _classCallCheck(this,t),this.html,this.id=e.id,this.title=e.title,this.poster=e.poster,this.lauch=e.lauch,this.category=e.category,this}return _createClass(t,[{key:"getItem",value:function(t){return"mobile"==t?this._createMobile():this._createDesktop(),this.html}},{key:"_createDesktop",value:function(){var t="";this.html='\n\t\t\t<a href="'.concat(this.id,'" class="boxItem" title="Перейти к ').concat(this.title,'">\n\t\t\t\t<div class="itemWrapper">\n\t\t\t\t\t<div class="itemBack" style="background-image: url(').concat(this.poster,'); background-size: cover; background-repeat: no-repeat;"></div>\n\t\t\t\t\t<div class="itemContent">\n\t\t\t\t\t\t<div class="itemTitle withValue">Title<span>').concat(this.title,'</span></div>\n\t\t\t\t\t\t<div class="itemLauchDate withValue">Launch<span>').concat(this.lauch,'</span></div>\n\t\t\t\t\t\t<div class="itemCategory withValue">Category<span>').concat(this.category,"</span></div>\n\t\t\t\t\t\t").concat(t,"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t")}},{key:"_createMobile",value:function(){this.html='\n\t\t\t<a href="'.concat(this.id,'" class="mobItem" title="Перейти к ').concat(this.title,'">\n\t\t\t\t<img class="mobileItem__image" src="').concat(this.poster,'" alt="">\n\t\t\t\t<div class="mobItem__info">\n\t\t\t\t\t<h2 class="paramLine">\n\t\t\t\t\t\t<span class="paramTitle">Title</span>\n\t\t\t\t\t\t<span class="paramValue">').concat(this.title,'</span>\n\t\t\t\t\t</h2>\n\t\t\t\t\t<div class="paramLine">\n\t\t\t\t\t\t<span class="paramTitle">Launch</span>\n\t\t\t\t\t\t<span class="paramValue">').concat(this.lauch,'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="paramLine">\n\t\t\t\t\t\t<span class="paramTitle">Category</span>\n\t\t\t\t\t\t<span class="paramValue">').concat(this.category,"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</a>")}}]),t}(),WorkList=function(){function t(e){return _classCallCheck(this,t),this.works=[],this.html=null,this.fragment=null,this._init(e),this}return _createClass(t,[{key:"_init",value:function(t){this.fragment=document.createDocumentFragment();for(var e=0;e<t.length;e++)this.addWork(new WorkItem(t[e]))}},{key:"addWork",value:function(t){this.works.push(t)}},{key:"getWorks",value:function(t,e){var i=document.createElement("div");if("mobile"==t){$(i).addClass("infiniteBox");for(var a=0;a<this.works.length;a++)$(this.fragment).append(this.works[a].getItem(t))}else{$(i).addClass("infiniteBox hoverAction");var n=this.works.slice(0);for(a=0;a<e.data_lines.length;a++){var s=n.splice(0,e.data_lines[a]),l="_".concat(e.line_types[a]);$(this.fragment).append(this[l](s,t))}}return $(i).append(this.fragment),this.html=i,i=null,this.fragment=document.createDocumentFragment(),this.html}},{key:"_oneBigTwoSmall",value:function(t,e){var i=t.slice(),a=document.createElement("div");$(a).addClass("infirow");var n=document.createElement("div");$(n).addClass("col-8"),$(n).append(i[0].getItem(e)),i.splice(0,1);var s=document.createElement("div");$(s).addClass("col-4");do{$(s).append(i[0].getItem(e)),i.splice(0,1)}while(i.length);return $(a).append(n),$(a).append(s),a}},{key:"_twoSmallOneBig",value:function(t,e){var i=t.slice(),a=document.createElement("div");$(a).addClass("infirow");var n=document.createElement("div");$(n).addClass("col-8"),$(n).append(i[0].getItem(e)),i.splice(0,1);var s=document.createElement("div");$(s).addClass("col-4");do{$(s).append(i[0].getItem(e)),i.splice(0,1)}while(i.length);return $(a).append(s),$(a).append(n),a}},{key:"_trioLine",value:function(t,e){var i=t.slice(),a=document.createElement("div");$(a).addClass("infirow");do{var n=document.createElement("div");$(n).addClass("col-4"),$(n).append(i[0].getItem(e)),$(a).append(n),i.splice(0,1)}while(i.length);return a}},{key:"_pairLine",value:function(t,e){var i=t.slice(),a=document.createElement("div");$(a).addClass("infirow");do{var n=document.createElement("div");$(n).addClass("col-6"),$(n).append(i[0].getItem(e)),$(a).append(n),i.splice(0,1)}while(i.length);return a}}]),t}(),Lines=function(){function t(e){_classCallCheck(this,t),this.data_length=e,this.clear_part=0,this.divided_part=0,this.data_lines=[],this.line_types=[],this._init()}return _createClass(t,[{key:"_init",value:function(){if(this.clear_part=Math.trunc(this.data_length/3),this.divided_part=this.data_length%3,2==this.divided_part?this.data_lines=this.data_lines.concat([2]):1==this.divided_part&&(0==this.clear_part?this.data_lines=this.data_lines.concat([2]):(this.clear_part--,this.data_lines=this.data_lines.concat([2,2]))),this.clear_part>0)for(var t=0;t<this.clear_part;t++)this.data_lines=this.data_lines.concat([3]);this._setLineTypesTrio()}},{key:"_initDouble",value:function(){if(this.clear_part=Math.trunc(this.data_length/5),this.divided_part=this.data_length%5,4==this.divided_part?this.data_lines=this.data_lines.concat([2,2]):3==this.divided_part?this.data_lines=this.data_lines.concat([3]):2==this.divided_part?this.data_lines=this.data_lines.concat([2]):1==this.divided_part&&(0==this.clear_part?this.data_lines=this.data_lines.concat([2]):(this.clear_part--,this.data_lines=this.data_lines.concat([3,3]))),this.clear_part>0)for(var t=0;t<this.clear_part;t++)this.data_lines=this.data_lines.concat([2,3]);this._setLineTypesDouble()}},{key:"_setLineTypesTrio",value:function(){for(var t=[],e=[],i=0;i<this.data_lines.length;i++)2==this.data_lines[i]?t.push(this.data_lines[i]):e.push(this.data_lines[i]);var a=this.data_lines.length;this.trio_type_tmp="",this.data_lines=[],this.line_types=[];var n=3;1==a&&(n=2);for(i=0;i<a;i++){var s=[],l=[];if(null!=t[i]&&(s=s.concat(t[i]),l=l.concat("pairLine")),null!=e[i]&&(s=s.concat(e[i]),l=l.concat(this._selectLineType(n))),!s.length)break;this.data_lines=this.data_lines.concat(s),this.line_types=this.line_types.concat(l)}2==this._selectCombination()&&(this.line_types.reverse(),this.data_lines.reverse())}},{key:"_setLineTypesDouble",value:function(){for(var t=[],e=[],i=0;i<this.data_lines.length;i++)2==this.data_lines[i]?t.push(this.data_lines[i]):e.push(this.data_lines[i]);var a=1,n=0,s=2,l=3;2==this._selectCombination()&&(a=0,n=1),0==this.clear_part&&(s=1,n=0,a=0,l=2);var r=this.data_lines.length;this.data_lines=[],this.line_types=new Array(r),this.data_lines=new Array(r);for(i=0;i<e.length;i++)this.data_lines[a]=3,this.line_types[a]=this._selectLineType(l),a+=s;for(i=0;i<t.length;i++)this.data_lines[n]=2,this.line_types[n]="pairLine",n+=s;this.data_lines=this.data_lines.filter(Boolean),this.line_types=this.line_types.filter(Boolean)}},{key:"_selectCombination",value:function(){return 1==randomInteger(1,2)?1:2}},{key:"_selectLineType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,e=0;do{e=randomInteger(1,t)}while(this.trio_type_tmp==e);switch(this.trio_type_tmp=e,e){case 1:return"twoSmallOneBig";case 2:return"oneBigTwoSmall";case 3:return"trioLine";default:return"Error"}}}]),t}(),Controller=function(){function t(e){return _classCallCheck(this,t),this.windowObj=$(window),this.edge=768,this.work_list=null,this.animation=null,this.original_data=null,this.current_view="",this.category="",this.container=$("#homePage"),this.init(e),this}return _createClass(t,[{key:"init",value:function(t){var e=this;this._initData(t),this.animation=new Motion,this.animation.init({elem:".infiniteBox",axis:"vertical",has_pause_evt:!0,delayAfterHover:2,container:this.container,on_hover_objs:".boxItem"}).initAnimation(),$(window).on("resize",function(t){e._setView()})}},{key:"_initData",value:function(t,e){this.original_data=t,this.work_list=new WorkList(t),this.lines=new Lines(this.work_list.works.length),this._setView(e)}},{key:"_setView",value:function(t){this.windowObj.width()<this.edge&&"mobile"!=this.current_view&&(this.current_view="mobile",null!=this.animation&&this.animation.animationOff(),this._changeView()),this.windowObj.width()>=this.edge&&"desktop"!=this.current_view&&(this.current_view="desktop",this._changeView(this.lines),null!=this.animation&&(this.animation.updateData(".infiniteBox"),this.animation.animationOn())),t&&this._changeView(this.lines),"desktop"==this.current_view&&this._redrawBackgrounds()}},{key:"_redrawBackgrounds",value:function(){var t=$(".boxItem");$.each(t,function(t,e){$(this).outerHeight($(this).outerWidth()/SCREEN_RATIO)})}},{key:"_changeView",value:function(t){this.container.empty(),this.container.append(this.work_list.getWorks(this.current_view,t))}},{key:"getData",value:function(t,e){var i=this;$.ajax({url:"/api/",type:"GET",data:{category:t},dataType:"json",success:function(t){t.length?(i.animation.stopMovement(),i._initData(t,!0),i.animation.updateData(".infiniteBox").initAnimation(),e()):console.log("Нет данных")}})}}]),t}();function randomInteger(t,e){var i=t-.5+Math.random()*(e-t+1);return i=Math.round(i)}function setCategory(t){$(".toggleBtn__text[globcat]").text(t)}var controller=new Controller(textData);$(".toggleList__item").on("click",function(t){var e=this;t.preventDefault();var i=$(this).attr("globcat");controller.getData(i,function(){$(".toggleList__item.-active-").removeClass("-active-"),$('.toggleList__item[globcat="'.concat(i,'"]')).addClass("-active-"),setCategory($(e).text())})}),$("#mobileCategory>.toggleBtn").on("click",function(t){var e=$(this),i=$("#mobileNav");e.hasClass("collapse")?i.addClass("-open-"):i.removeClass("-open-")});